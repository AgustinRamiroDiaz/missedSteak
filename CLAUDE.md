# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

### Development
```bash
# Start development server (also generates recipes.json)
npm run dev

# Build for production (generates recipes.json + Next.js build)
npm run build

# Generate recipes.json from lib/recipes/ JSON files
npm run generate-recipes
```

### Testing Deployment
```bash
# Test with GitHub Pages base path
BASE_PATH=/missedSteak npm run build
```

## Architecture Overview

This is a **Next.js static site** for a vegetarian recipe website that uses **client-side rendering only** (no SSR/SSG) to avoid hydration issues. The site deploys to GitHub Pages with automatic base path configuration.

### Key Architectural Decisions

1. **Client-Side Only Rendering**: Uses `_app.tsx` with `isClient` state guard to prevent SSR entirely
2. **Static Data Generation**: Recipe JSON files are aggregated at build time into `public/recipes.json`
3. **GitHub Integration**: Recipe management (add/delete) opens GitHub file management URLs
4. **Bootstrap + jQuery**: Uses external CDN resources loaded in `_document.tsx`

### Data Flow

1. **Source**: Individual recipe JSON files in `lib/recipes/{category}/`
2. **Build**: `scripts/generate-recipes.js` aggregates all recipes into `public/recipes.json`
3. **Runtime**: Client fetches aggregated data from `/recipes.json`
4. **Display**: React components render recipes with Bootstrap modals

### Component Structure

- **Layout**: Main wrapper with navigation, footer, and "Add Recipe" modal
- **RecipeModal**: Individual recipe display with GitHub delete integration
- **Dynamic Imports**: All components use `dynamic()` with `{ ssr: false }`

### Recipe Management

- **Add Recipe**: Modal form → GitHub file creation URL
- **Delete Recipe**: Button → GitHub file deletion URL
- **Edit Recipe**: Manual GitHub file editing (no UI)
- **Repository**: Set via `GITHUB_USERNAME_SLASH_REPO` environment variable

### Build Process

1. `npm run generate-recipes` - Aggregates JSON files from `lib/recipes/`
2. `next build` - Static site generation to `out/` directory
3. GitHub Actions deploys `out/` to GitHub Pages with `BASE_PATH` set

### Environment Variables

- `GITHUB_USERNAME_SLASH_REPO`: GitHub repository for recipe management
- `BASE_PATH`: Deployment base path (auto-set for GitHub Pages)

### Recipe Data Structure

```typescript
interface Recipe {
  title: string;
  image: string;        // URL or local path
  instructions: string; // HTML with <br> tags
  link?: string;       // Optional external recipe link
}
```

### Important Files

- `scripts/generate-recipes.js`: Aggregates recipe JSON files
- `lib/recipes/{category}/`: Source recipe JSON files
- `public/recipes.json`: Generated aggregated recipes (build artifact)
- `pages/_app.tsx`: Client-side rendering guard
- `next.config.js`: Static export + base path configuration

### Development Notes

- All recipe images should be in `/public/assets/img/portfolio/`
- Recipe instructions use HTML with `<br>` tags for line breaks
- Modal IDs are generated by slugifying recipe titles
- The site uses Bootstrap 4.6 with jQuery for modal interactions
- GitHub integration requires the repository to be public for file management URLs to work